<div class="store-header">
  <div class="container">
    <h1>Loja</h1>
    <p>{{ products.length }} produtos</p>
  </div>
</div>

<section class="store container">

  @if (loading) {
    <div class="store__loading">Carregando produtos...</div>
  } @else if (error) {
    <div class="store__error">Não foi possível carregar os produtos. Tente novamente.</div>
  } @else {
    <div class="store__grid">
      @for (p of products; track p.id) {
        <div class="product-card" [routerLink]="['/loja', p.id]">
          <div class="product-card__img-wrap">
            @if (getImage(p)) {
              <img class="product-card__img" [src]="getImage(p)" [alt]="p.name" />
            } @else {
              <div class="product-card__img product-card__img--placeholder">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                  <rect x="3" y="3" width="18" height="18" rx="1"/>
                  <circle cx="8.5" cy="8.5" r="1.5"/>
                  <polyline points="21 15 16 10 5 21"/>
                </svg>
              </div>
            }
            @if (p.on_sale) {
              <span class="product-card__badge">Sale</span>
            }
          </div>

          <div class="product-card__body">
            <h3 class="product-card__name">{{ p.name }}</h3>

            <div class="product-card__pricing">
              @if (p.on_sale && p.regular_price) {
                <span class="product-card__price-old">R$ {{ p.regular_price }}</span>
              }
              <span class="product-card__price">R$ {{ p.price }}</span>
            </div>

            @if (getSizes(p).length) {
              <div class="product-card__sizes">
                @for (s of getSizes(p); track s) {
                  <span class="product-card__size">{{ s }}</span>
                }
              </div>
            }

            <button class="btn btn--primary product-card__btn">Ver produto</button>
          </div>
        </div>
      }
    </div>
  }

</section>
